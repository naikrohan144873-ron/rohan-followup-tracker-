<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Add Follow-Up</title>
  <link rel="manifest" href="/manifest.json"/>
  <link rel="stylesheet" href="/style.css"/>
</head>
<body>
  <div class="app">
    <div class="header">
      <div class="h-title">Add Follow-Up</div>
      <div class="h-actions">
        <button class="icon-btn" id="back">←</button>
      </div>
    </div>

    <div class="container">
      <form id="followUpForm" class="form">
        <label>Company
          <select id="company" class="input" required>
            <option value="">Select Company</option>
            <option>Greenland</option>
            <option>Profusion</option>
            <option>Other Projects</option>
          </select>
        </label>

        <label>Department
          <select id="department" class="input" required>
            <option value="">Select Department</option>
            <option>Sales</option>
            <option>Marketing</option>
            <option>Admin</option>
            <option>Laisoning</option>
            <option>Others</option>
          </select>
        </label>

        <label>Person Name
          <input id="personName" class="input" required placeholder="Enter name"/>
        </label>

        <div style="display:flex;gap:8px;">
          <label style="flex:1">Follow-up Date
            <input id="followDate" class="input" type="date" required/>
          </label>
          <label style="flex:1">Follow-up Time
            <input id="followTime" class="input" type="time" required/>
          </label>
        </div>

        <label>Status
          <select id="status" class="input">
            <option>Pending</option>
            <option>In Progress</option>
            <option>Completed</option>
          </select>
        </label>

        <label>Notes
          <textarea id="notes" class="input" placeholder="Add any details..."></textarea>
        </label>

        <div class="save-row">
          <button type="submit" class="primary">Save</button>
          <button type="button" id="cancel" class="btn btn-danger">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <script src="/app.js"></script>
<script>
  // Inline fallback submit handler — saves form directly to localStorage and redirects
  (function(){
    const LS = 'rohan_tasks_v1';
    function nowISO(){ return new Date().toISOString(); }
    function getTasks(){ try{ return JSON.parse(localStorage.getItem(LS) || '[]'); }catch(e){ return []; } }
    function saveTasks(t){ localStorage.setItem(LS, JSON.stringify(t)); }

    document.addEventListener('DOMContentLoaded', ()=>{
      const form = document.getElementById('followUpForm');
      if(!form) return;
      form.addEventListener('submit', (ev)=>{
        ev.preventDefault();
        try {
          const company = document.getElementById('company')?.value || '';
          const department = document.getElementById('department')?.value || '';
          const personName = document.getElementById('personName')?.value || '';
          const followDate = document.getElementById('followDate')?.value || '';
          const followTime = document.getElementById('followTime')?.value || '';
          const status = document.getElementById('status')?.value || 'Pending';
          const notes = document.getElementById('notes')?.value || '';
          const id = 't_' + Date.now();
          const task = { id, company, department, personName, followDate, followTime, status, notes, createdAt: nowISO() };
          const arr = getTasks(); arr.push(task); saveTasks(arr);
          // redirect to dashboard
          location.href = '/index.html';
        } catch (e) {
          alert('Save failed: ' + e.message);
        }
      });

      // make Cancel button go back
      const cancel = document.getElementById('cancel');
      if(cancel) cancel.addEventListener('click', ()=> location.href = '/index.html');
    });
  })();
</script></body>
</html>
